<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Multi-Engine Simulator</title>
  <style>
    body {
      background: #111;
      color: #0f0;
      font-family: monospace;
      text-align: center;
      padding: 2em;
    }
    select, button {
      padding: 0.5em;
      font-size: 1em;
      margin: 1em;
      background: #0f0;
      color: #000;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background: #6f6;
    }
  </style>
</head>
<body>
  <h1>Engine Sound Synth - Sample Based</h1>

  <div>
    <label for="engineType">Engine Type:</label>
    <select id="engineType">
      <option value="v8">V8</option>
      <option value="inline6">Inline-6</option>
      <option value="rotary">Rotary</option>
      <option value="bike">Motorcycle</option>
    </select>
  </div>

  <div>
    <button onclick="playIdle()">Start Idle</button>
    <button onclick="playRev()">Rev Engine</button>
    <button onclick="stopAll()">Stop</button>
  </div>

  <div>
    <label><input type="checkbox" id="turboToggle" /> Enable Turbo</label>
  </div>

  <script>
    const AudioContext = window.AudioContext || window.webkitAudioContext;
    const ctx = new AudioContext();

    const sounds = {
      v8: {
        idle: 'https://cdn.pixabay.com/download/audio/2022/03/01/audio_1529bd6dc2.mp3?filename=v8-idle.mp3',
        rev: 'https://cdn.pixabay.com/download/audio/2022/03/01/audio_3cfae9ef41.mp3?filename=v8-rev.mp3'
      },
      inline6: {
        idle: 'https://cdn.pixabay.com/download/audio/2021/09/09/audio_d582b464e6.mp3?filename=engine-loop.mp3',
        rev: 'https://cdn.pixabay.com/download/audio/2021/08/09/audio_841f3c4f20.mp3?filename=revving.mp3'
      },
      rotary: {
        idle: 'https://cdn.pixabay.com/download/audio/2021/09/30/audio_6b771e79e0.mp3?filename=rotary-idle.mp3',
        rev: 'https://cdn.pixabay.com/download/audio/2022/03/03/audio_d81e0b6a04.mp3?filename=rotary-rev.mp3'
      },
      bike: {
        idle: 'https://cdn.pixabay.com/download/audio/2021/09/03/audio_3d9ed72ba4.mp3?filename=motorbike-idle.mp3',
        rev: 'https://cdn.pixabay.com/download/audio/2021/09/03/audio_61ea490a80.mp3?filename=motorbike-rev.mp3'
      },
      turbo: 'https://cdn.pixabay.com/download/audio/2021/11/26/audio_61f8e6fd03.mp3?filename=turbo-boost.mp3'
    };

    let sources = [];

    async function loadSound(url) {
      const response = await fetch(url);
      const arrayBuffer = await response.arrayBuffer();
      return await ctx.decodeAudioData(arrayBuffer);
    }

    async function playSound(url, loop = false) {
      const buffer = await loadSound(url);
      const source = ctx.createBufferSource();
      source.buffer = buffer;
      source.loop = loop;
      source.connect(ctx.destination);
      source.start();
      sources.push(source);
    }

    async function playIdle() {
      stopAll();
      const engine = document.getElementById('engineType').value;
      await playSound(sounds[engine].idle, true);
    }

    async function playRev() {
      stopAll();
      const engine = document.getElementById('engineType').value;
      await playSound(sounds[engine].rev, false);

      if (document.getElementById('turboToggle').checked) {
        setTimeout(() => {
          playSound(sounds.turbo, false);
        }, 800); // Simulate turbo delay
      }
    }

    function stopAll() {
      sources.forEach(src => {
        try {
          src.stop();
        } catch (e) {}
      });
      sources = [];
    }
  </script>
</body>
</html>